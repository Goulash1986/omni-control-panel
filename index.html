<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>OMNI-CONTROL 2026</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=JetBrains+Mono:wght@300;400;600&display=swap');
:root{--bg:#0a0a0f;--bg2:#111118;--bg3:#1a1a24;--border:#2a2a3a;--accent:#7c3aed;--accent2:#a855f7;--green:#10b981;--red:#ef4444;--yellow:#f59e0b;--blue:#3b82f6;--text:#e2e8f0;--muted:#64748b;}
*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--bg);color:var(--text);font-family:'JetBrains Mono',monospace;font-size:13px;min-height:100vh;}
body::before{content:'';position:fixed;inset:0;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(124,58,237,.015) 2px,rgba(124,58,237,.015) 4px);pointer-events:none;z-index:9999;}

.header{position:sticky;top:0;z-index:100;background:rgba(10,10,15,.97);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);padding:0 16px;height:52px;display:flex;align-items:center;justify-content:space-between;}
.logo{font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:3px;background:linear-gradient(135deg,var(--accent2),var(--blue));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.hdr-r{display:flex;align-items:center;gap:10px;}
.dot{width:6px;height:6px;border-radius:50%;background:var(--green);box-shadow:0 0 6px var(--green);animation:pulse 2s infinite;}
@keyframes pulse{0%,100%{opacity:1;}50%{opacity:.4;}}
.btn-api{background:none;border:1px solid var(--border);color:var(--muted);padding:4px 10px;border-radius:6px;font-family:inherit;font-size:10px;cursor:pointer;letter-spacing:1px;transition:all .2s;}
.btn-api:hover{border-color:var(--accent);color:var(--text);}

.nav{display:flex;gap:2px;padding:8px 12px;background:var(--bg2);border-bottom:1px solid var(--border);overflow-x:auto;scrollbar-width:none;}
.nav::-webkit-scrollbar{display:none;}
.nb{padding:7px 13px;border:none;background:transparent;color:var(--muted);font-family:'JetBrains Mono',monospace;font-size:11px;font-weight:600;letter-spacing:1px;text-transform:uppercase;cursor:pointer;border-radius:6px;white-space:nowrap;transition:all .2s;}
.nb.active{background:rgba(124,58,237,.15);color:var(--accent2);border:1px solid rgba(124,58,237,.3);}
.nb:not(.active):hover{color:var(--text);background:var(--bg3);}
.bdg{display:inline-flex;align-items:center;justify-content:center;min-width:16px;height:16px;padding:0 4px;border-radius:8px;background:var(--accent);color:white;font-size:10px;font-weight:700;margin-left:4px;}

.page{display:none;padding:16px;animation:fi .25s ease;}
.page.active{display:block;}
@keyframes fi{from{opacity:0;transform:translateY(6px);}to{opacity:1;transform:translateY(0);}}

.g4{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:14px;}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:14px;}
@media(min-width:580px){.g4{grid-template-columns:repeat(4,1fr);}}

.stat{background:var(--bg2);border:1px solid var(--border);border-radius:10px;padding:14px;position:relative;overflow:hidden;transition:border-color .2s;}
.stat:hover{border-color:var(--accent);}
.stat::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:var(--al,var(--accent));}
.sl{font-size:10px;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;}
.sv{font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:1px;line-height:1;}
.ss{font-size:10px;margin-top:4px;color:var(--muted);}

.card{background:var(--bg2);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:12px;}
.ct{font-size:10px;letter-spacing:2px;text-transform:uppercase;color:var(--muted);margin-bottom:14px;display:flex;align-items:center;justify-content:space-between;gap:8px;}
.ctl{flex:1;height:1px;background:var(--border);}

.tbl{width:100%;border-collapse:collapse;}
.tbl th{font-size:10px;letter-spacing:1px;text-transform:uppercase;color:var(--muted);padding:8px 10px;text-align:left;border-bottom:1px solid var(--border);}
.tbl td{padding:10px;border-bottom:1px solid rgba(42,42,58,.5);vertical-align:middle;}
.tbl tr:last-child td{border-bottom:none;}
.tbl tr:hover td{background:rgba(124,58,237,.04);}

.st{display:inline-flex;align-items:center;gap:4px;padding:3px 8px;border-radius:4px;font-size:10px;font-weight:600;}
.st-pub,.st-act{background:rgba(16,185,129,.12);color:var(--green);}
.st-drf{background:rgba(100,116,139,.12);color:var(--muted);}
.st-sch,.st-pen{background:rgba(245,158,11,.12);color:var(--yellow);}
.st-can,.st-del{background:rgba(239,68,68,.12);color:var(--red);}

.btn{padding:8px 16px;border-radius:7px;border:none;font-family:'JetBrains Mono',monospace;font-size:11px;font-weight:600;letter-spacing:1px;text-transform:uppercase;cursor:pointer;transition:all .2s;}
.bp{background:var(--accent);color:white;}
.bp:hover{background:var(--accent2);transform:translateY(-1px);}
.bg{background:transparent;color:var(--muted);border:1px solid var(--border);}
.bg:hover{border-color:var(--accent);color:var(--text);}
.bd{background:rgba(239,68,68,.1);color:var(--red);border:1px solid rgba(239,68,68,.2);}
.bsuc{background:rgba(16,185,129,.15);color:var(--green);border:1px solid rgba(16,185,129,.3);}
.bsm{padding:4px 10px;font-size:10px;}

.fg{margin-bottom:14px;}
.fl{font-size:10px;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;}
.fi,.fs,.fta{width:100%;background:var(--bg3);border:1px solid var(--border);border-radius:7px;padding:9px 12px;color:var(--text);font-family:'JetBrains Mono',monospace;font-size:12px;outline:none;transition:border-color .2s;}
.fi:focus,.fs:focus,.fta:focus{border-color:var(--accent);}
.fta{resize:vertical;min-height:90px;line-height:1.6;}
.fs option{background:var(--bg3);}
.fr2{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.fa{display:flex;gap:8px;margin-top:16px;}

.sh{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;}
.stit{font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:2px;}

.tabs{display:flex;gap:2px;margin-bottom:14px;background:var(--bg2);border-radius:8px;padding:4px;overflow-x:auto;}
.tab{padding:6px 12px;border:none;background:transparent;color:var(--muted);font-family:'JetBrains Mono',monospace;font-size:10px;font-weight:600;cursor:pointer;border-radius:6px;transition:all .2s;white-space:nowrap;}
.tab.active{background:var(--accent);color:white;}

.mo{position:fixed;inset:0;background:rgba(0,0,0,.87);display:flex;align-items:flex-end;justify-content:center;z-index:1000;backdrop-filter:blur(8px);}
.mb{background:var(--bg2);border:1px solid var(--border);border-radius:16px 16px 0 0;padding:20px;width:100%;max-width:600px;max-height:90vh;overflow-y:auto;animation:su .3s ease;}
@keyframes su{from{transform:translateY(100%);}to{transform:translateY(0);}}
.mt{font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:2px;margin-bottom:16px;display:flex;justify-content:space-between;align-items:center;}
.mc{background:none;border:none;color:var(--muted);font-size:20px;cursor:pointer;padding:4px;}

.pr{display:flex;align-items:center;gap:10px;margin-bottom:10px;}
.pl{width:90px;font-size:11px;color:var(--muted);}
.pw{flex:1;height:6px;background:var(--bg3);border-radius:3px;overflow:hidden;}
.pb{height:100%;border-radius:3px;transition:width 1s ease;}
.pv{width:50px;text-align:right;font-size:11px;}

.chw{position:relative;height:180px;margin-top:8px;}

.fi-row{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid rgba(42,42,58,.4);}
.fi-row:last-child{border-bottom:none;}
.fi-lbl{font-size:12px;color:var(--muted);}
.fi-val{font-size:13px;font-weight:600;}
.fi-val.g{color:var(--green);}
.fi-val.r{color:var(--red);}

.av{width:30px;height:30px;border-radius:8px;background:linear-gradient(135deg,var(--accent),var(--blue));display:inline-flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:white;}
.rl{padding:2px 7px;border-radius:4px;font-size:10px;font-weight:600;}
.rl-o{background:rgba(168,85,247,.15);color:var(--accent2);border:1px solid rgba(168,85,247,.3);}
.rl-a{background:rgba(59,130,246,.12);color:var(--blue);border:1px solid rgba(59,130,246,.3);}
.rl-e{background:rgba(16,185,129,.12);color:var(--green);border:1px solid rgba(16,185,129,.3);}

.feed-item{display:flex;gap:10px;padding:10px 0;border-bottom:1px solid rgba(42,42,58,.4);}
.feed-item:last-child{border-bottom:none;}
.feed-ic{width:28px;height:28px;border-radius:8px;background:var(--bg3);display:flex;align-items:center;justify-content:center;font-size:13px;flex-shrink:0;}

.poster-banner{height:110px;background:linear-gradient(135deg,#1e0a3c,#0d1b4b);display:flex;align-items:center;justify-content:center;font-size:44px;border-radius:10px 10px 0 0;}

.setup-ov{position:fixed;inset:0;background:rgba(0,0,0,.93);display:flex;align-items:center;justify-content:center;z-index:9999;backdrop-filter:blur(12px);}
.setup-box{background:var(--bg2);border:1px solid var(--border);border-radius:14px;padding:28px;width:90%;max-width:380px;}

::-webkit-scrollbar{width:4px;height:4px;}
::-webkit-scrollbar-track{background:var(--bg);}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px;}
::-webkit-scrollbar-thumb:hover{background:var(--accent);}
</style>
</head>
<body>

<header class="header">
  <div class="logo">OMNI-CONTROL</div>
  <div class="hdr-r">
    <div class="dot"></div>
    <button class="btn-api" onclick="showSetup()">‚öô API</button>
  </div>
</header>

<nav class="nav">
  <button class="nb active" onclick="gp('dashboard',this)">üìä –î–∞—à–±–æ—Ä–¥</button>
  <button class="nb" onclick="gp('content',this)">üì¶ –ö–æ–Ω—Ç–µ–Ω—Ç</button>
  <button class="nb" onclick="gp('ads',this)">üíº –†–µ–∫–ª–∞–º–∞</button>
  <button class="nb" onclick="gp('finance',this)">üí∞ –§–∏–Ω–∞–Ω—Å—ã</button>
  <button class="nb" onclick="gp('team',this)">üë• –ö–æ–º–∞–Ω–¥–∞<span class="bdg" id="rBdg">0</span></button>
  <button class="nb" onclick="gp('hero',this)">üåü –ü–µ—Ä—Å–æ–Ω–∞–∂</button>
  <button class="nb" onclick="gp('logs',this)">üìã –õ–æ–≥–∏</button>
  <button class="nb" onclick="gp('bset',this)">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
</nav>

<!-- ‚ñà‚ñà DASHBOARD ‚ñà‚ñà -->
<div id="page-dashboard" class="page active">
  <div class="g4">
    <div class="stat" style="--al:var(--accent2)"><div class="sl">–ü–æ—Å—Ç–æ–≤</div><div class="sv" id="s-p">‚Äî</div><div class="ss">–≤—Å–µ–≥–æ</div></div>
    <div class="stat" style="--al:var(--green)"><div class="sl">–†–µ–∫–ª–∞–º–∞</div><div class="sv" id="s-a">‚Äî</div><div class="ss">–∞–∫—Ç–∏–≤–Ω—ã—Ö</div></div>
    <div class="stat" style="--al:var(--blue)"><div class="sl">–ö–æ–º–∞–Ω–¥–∞</div><div class="sv" id="s-t">‚Äî</div><div class="ss">—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div></div>
    <div class="stat" style="--al:var(--yellow)"><div class="sl">–ó–∞—è–≤–∫–∏</div><div class="sv" id="s-r">‚Äî</div><div class="ss">–æ–∂–∏–¥–∞—é—Ç</div></div>
  </div>
  <div class="g2">
    <div class="card"><div class="ct">–ü—É–±–ª–∏–∫–∞—Ü–∏–∏ <span class="ctl"></span></div><div class="chw"><canvas id="cPosts"></canvas></div></div>
    <div class="card"><div class="ct">–°—Ç–∞—Ç—É—Å—ã <span class="ctl"></span></div><div class="chw"><canvas id="cStatus"></canvas></div></div>
  </div>
  <div class="card"><div class="ct">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å <span class="ctl"></span></div><div id="feed">‚Äî</div></div>
  <div class="card">
    <div class="ct">–†–µ–∫–ª–∞–º–Ω—ã–π ROI <span class="ctl"></span></div>
    <div class="pr"><div class="pl">Impressions</div><div class="pw"><div class="pb" id="bI" style="background:var(--accent2)"></div></div><div class="pv" id="vI">‚Äî</div></div>
    <div class="pr"><div class="pl">Clicks</div><div class="pw"><div class="pb" id="bC" style="background:var(--blue)"></div></div><div class="pv" id="vC">‚Äî</div></div>
    <div class="pr"><div class="pl">CTR</div><div class="pw"><div class="pb" id="bT" style="background:var(--green)"></div></div><div class="pv" id="vT">‚Äî</div></div>
  </div>
</div>

<!-- ‚ñà‚ñà CONTENT ‚ñà‚ñà -->
<div id="page-content" class="page">
  <div class="sh"><div class="stit">–ö–æ–Ω—Ç–µ–Ω—Ç</div><button class="btn bp bsm" onclick="om('m-post')">+ –ù–æ–≤—ã–π –ø–æ—Å—Ç</button></div>
  <div class="tabs">
    <button class="tab active" onclick="fCon('all',this)">–í—Å–µ</button>
    <button class="tab" onclick="fCon('published',this)">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ</button>
    <button class="tab" onclick="fCon('draft',this)">–ß–µ—Ä–Ω–æ–≤–∏–∫–∏</button>
    <button class="tab" onclick="fCon('scheduled',this)">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</button>
  </div>
  <div class="card">
    <div class="ct">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ <span class="ctl"></span><button class="btn bg bsm" onclick="om('m-cat')">+ –î–æ–±–∞–≤–∏—Ç—å</button></div>
    <div id="catList" style="display:flex;flex-wrap:wrap;gap:6px">‚Äî</div>
  </div>
  <div class="card" style="padding:0;overflow:hidden">
    <table class="tbl">
      <thead><tr><th>–ü–æ—Å—Ç</th><th>–°—Ç–∞—Ç—É—Å</th><th>–î–∞—Ç–∞</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead>
      <tbody id="conTbl"><tr><td colspan="4" style="text-align:center;color:var(--muted);padding:24px">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr></tbody>
    </table>
  </div>
</div>

<!-- ‚ñà‚ñà ADS ‚ñà‚ñà -->
<div id="page-ads" class="page">
  <div class="sh"><div class="stit">–†–µ–∫–ª–∞–º–∞</div><button class="btn bp bsm" onclick="om('m-ad')">+ –ö–∞–º–ø–∞–Ω–∏—è</button></div>
  <div class="g4">
    <div class="stat" style="--al:var(--green)"><div class="sl">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div><div class="sv" id="aAct">‚Äî</div></div>
    <div class="stat" style="--al:var(--yellow)"><div class="sl">–û–∂–∏–¥–∞—é—Ç</div><div class="sv" id="aPen">‚Äî</div></div>
    <div class="stat" style="--al:var(--accent2)"><div class="sl">–ë—é–¥–∂–µ—Ç</div><div class="sv" id="aBud">‚Äî</div></div>
    <div class="stat" style="--al:var(--blue)"><div class="sl">–°—Ä. CTR</div><div class="sv" id="aCtr">‚Äî</div></div>
  </div>
  <div class="card" style="padding:0;overflow:hidden">
    <table class="tbl">
      <thead><tr><th>–ö–∞–º–ø–∞–Ω–∏—è</th><th>–†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—å</th><th>–°—Ç–∞—Ç—É—Å</th><th>CTR</th><th>–ë—é–¥–∂–µ—Ç</th><th></th></tr></thead>
      <tbody id="adsTbl"><tr><td colspan="6" style="text-align:center;color:var(--muted);padding:24px">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr></tbody>
    </table>
  </div>
</div>

<!-- ‚ñà‚ñà FINANCE ‚ñà‚ñà -->
<div id="page-finance" class="page">
  <div class="stit" style="margin-bottom:14px">–§–∏–Ω–∞–Ω—Å—ã</div>
  <div class="g4">
    <div class="stat" style="--al:var(--green)"><div class="sl">–î–æ—Ö–æ–¥</div><div class="sv" id="fInc">‚Äî</div><div class="ss" style="color:var(--green)">UAH</div></div>
    <div class="stat" style="--al:var(--red)"><div class="sl">–†–∞—Å—Ö–æ–¥—ã</div><div class="sv" id="fExp">‚Äî</div><div class="ss" style="color:var(--red)">UAH</div></div>
    <div class="stat" style="--al:var(--accent2)"><div class="sl">–ü—Ä–∏–±—ã–ª—å</div><div class="sv" id="fPro">‚Äî</div><div class="ss">UAH</div></div>
    <div class="stat" style="--al:var(--blue)"><div class="sl">–ö–∞–º–ø–∞–Ω–∏–π</div><div class="sv" id="fCam">‚Äî</div></div>
  </div>
  <div class="card"><div class="ct">–ü–æ —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—è–º <span class="ctl"></span></div><div id="finTbl">‚Äî</div></div>
  <div class="card">
    <div class="ct">–°–≤–æ–¥–∫–∞ <span class="ctl"></span></div>
    <div class="fi-row"><div class="fi-lbl">–û–±—â–∏–π –±—é–¥–∂–µ—Ç</div><div class="fi-val g" id="fTot">‚Äî</div></div>
    <div class="fi-row"><div class="fi-lbl">–°—Ä–µ–¥–Ω–∏–π –±—é–¥–∂–µ—Ç</div><div class="fi-val" id="fAvg">‚Äî</div></div>
    <div class="fi-row"><div class="fi-lbl">–ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π</div><div class="fi-val" id="fAct2">‚Äî</div></div>
    <div class="fi-row"><div class="fi-lbl">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö</div><div class="fi-val" id="fDone">‚Äî</div></div>
  </div>
</div>

<!-- ‚ñà‚ñà TEAM ‚ñà‚ñà -->
<div id="page-team" class="page">
  <div class="stit" style="margin-bottom:14px">–ö–æ–º–∞–Ω–¥–∞</div>
  <div id="reqBlk" style="display:none">
    <div class="card" style="border-color:rgba(245,158,11,.3)">
      <div class="ct" style="color:var(--yellow)">‚ö† –ó–∞—è–≤–∫–∏ –Ω–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ <span class="ctl"></span></div>
      <div id="reqLst"></div>
    </div>
  </div>
  <div class="card" style="padding:0;overflow:hidden">
    <table class="tbl">
      <thead><tr><th>–£—á–∞—Å—Ç–Ω–∏–∫</th><th>–†–æ–ª—å</th><th>Telegram ID</th><th>–î–∞—Ç–∞</th></tr></thead>
      <tbody id="teamTbl"><tr><td colspan="4" style="text-align:center;color:var(--muted);padding:24px">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr></tbody>
    </table>
  </div>
</div>

<!-- ‚ñà‚ñà HERO ‚ñà‚ñà -->
<div id="page-hero" class="page">
  <div class="sh"><div class="stit">–ü–µ—Ä—Å–æ–Ω–∞–∂</div><button class="btn bp bsm" onclick="openEditHero()">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button></div>
  <div class="card" style="padding:0;overflow:hidden">
    <div class="poster-banner" id="hBanner">üåü</div>
    <div style="padding:14px">
      <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px" id="hName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
      <div style="font-size:11px;color:var(--muted);margin-top:4px;line-height:1.6" id="hBio">‚Äî</div>
    </div>
  </div>
  <div class="card">
    <div class="ct">–ë–∏–æ–≥—Ä–∞—Ñ–∏–∏ <span class="ctl"></span></div>
    <div class="fi-row"><div class="fi-lbl">üá∑üá∫ RU</div><div style="font-size:11px;max-width:65%;text-align:right" id="hBioRu">‚Äî</div></div>
    <div class="fi-row"><div class="fi-lbl">üá∫üá¶ UK</div><div style="font-size:11px;max-width:65%;text-align:right" id="hBioUk">‚Äî</div></div>
    <div class="fi-row"><div class="fi-lbl">üá¨üáß EN</div><div style="font-size:11px;max-width:65%;text-align:right" id="hBioEn">‚Äî</div></div>
  </div>
  <div class="card"><div class="ct">–õ–∏—á–Ω–æ—Å—Ç—å <span class="ctl"></span></div><div id="hPers" style="font-size:12px;color:var(--muted);line-height:1.7">‚Äî</div></div>

  <div class="card">
    <div class="ct">üñº –ü–æ—Å—Ç–µ—Ä –Ω–∞–¥ –ø—É–ª—å—Ç–æ–º <span class="ctl"></span><button class="btn bg bsm" onclick="om('m-poster')">+ –î–æ–±–∞–≤–∏—Ç—å</button></div>
    <div style="font-size:11px;color:var(--muted);margin-bottom:12px">–ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–Ω–¥–æ–º–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
    <div id="posterList">‚Äî</div>
  </div>
</div>

<!-- ‚ñà‚ñà LOGS ‚ñà‚ñà -->
<div id="page-logs" class="page">
  <div class="sh"><div class="stit">–õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π</div></div>
  <div class="tabs">
    <button class="tab active" onclick="fLog('all',this)">–í—Å–µ</button>
    <button class="tab" onclick="fLog('publish',this)">–ü—É–±–ª–∏–∫–∞—Ü–∏–∏</button>
    <button class="tab" onclick="fLog('ban',this)">–ë–∞–Ω—ã</button>
    <button class="tab" onclick="fLog('role',this)">–†–æ–ª–∏</button>
    <button class="tab" onclick="fLog('panic',this)">Panic</button>
  </div>
  <div class="card" style="padding:0;overflow:hidden">
    <table class="tbl">
      <thead><tr><th>–î–µ–π—Å—Ç–≤–∏–µ</th><th>–ê–≤—Ç–æ—Ä</th><th>–û–±—ä–µ–∫—Ç</th><th>–í—Ä–µ–º—è</th></tr></thead>
      <tbody id="logsTbl"><tr><td colspan="4" style="text-align:center;color:var(--muted);padding:24px">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr></tbody>
    </table>
  </div>
</div>

<!-- ‚ñà‚ñà BOT SETTINGS ‚ñà‚ñà -->
<div id="page-bset" class="page">
  <div class="stit" style="margin-bottom:14px">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞</div>
  <div class="card">
    <div class="ct">–û—Å–Ω–æ–≤–Ω–æ–µ <span class="ctl"></span></div>
    <div class="fg"><label class="fl">–ù–∞–∑–≤–∞–Ω–∏–µ / Username –±–æ—Ç–∞</label><input class="fi" id="set-bn" placeholder="@YourBot"></div>
    <div class="fg"><label class="fl">ID –∫–∞–Ω–∞–ª–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–π</label><input class="fi" id="set-ch" placeholder="-1001234567890"></div>
    <div class="fg"><label class="fl">–Ø–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</label>
      <select class="fs" id="set-lg"><option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option><option value="uk">üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option><option value="en">üá¨üáß English</option></select>
    </div>
  </div>
  <div class="card">
    <div class="ct">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è <span class="ctl"></span></div>
    <div class="fi-row"><div class="fi-lbl">–ù–æ–≤—ã–µ –∑–∞—è–≤–∫–∏</div><label style="cursor:pointer;display:flex;align-items:center;gap:6px"><input type="checkbox" id="n-req" checked><span style="font-size:11px">–í–∫–ª—é—á–µ–Ω–æ</span></label></div>
    <div class="fi-row"><div class="fi-lbl">–ü—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ—Å—Ç–∞</div><label style="cursor:pointer;display:flex;align-items:center;gap:6px"><input type="checkbox" id="n-pub" checked><span style="font-size:11px">–í–∫–ª—é—á–µ–Ω–æ</span></label></div>
    <div class="fi-row"><div class="fi-lbl">–ù–æ–≤–∞—è —Ä–µ–∫–ª–∞–º–∞</div><label style="cursor:pointer;display:flex;align-items:center;gap:6px"><input type="checkbox" id="n-ads"><span style="font-size:11px">–í–∫–ª—é—á–µ–Ω–æ</span></label></div>
    <div class="fi-row"><div class="fi-lbl">Panic Mode</div><label style="cursor:pointer;display:flex;align-items:center;gap:6px"><input type="checkbox" id="n-pan" checked><span style="font-size:11px">–í–∫–ª—é—á–µ–Ω–æ</span></label></div>
  </div>
  <div class="card">
    <div class="ct">–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ <span class="ctl"></span></div>
    <div class="fg"><label class="fl">–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (–º–∏–Ω)</label><input class="fi" id="set-int" type="number" value="1" min="1" max="60"></div>
    <div class="fg"><label class="fl">–ê–≤—Ç–æ-—É–¥–∞–ª–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º—ã (—á)</label><input class="fi" id="set-del" type="number" value="24" min="1"></div>
  </div>
  <div style="display:flex;gap:10px;flex-wrap:wrap">
    <button class="btn bp" onclick="saveBotSettings()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    <button class="btn bd" onclick="confirmRestart()">üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞</button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê MODALS ‚ïê‚ïê‚ïê‚ïê -->

<!-- New Post -->
<div id="m-post" class="mo" style="display:none" onclick="if(event.target===this)cm('m-post')">
<div class="mb">
  <div class="mt">–ù–æ–≤—ã–π –ø–æ—Å—Ç <button class="mc" onclick="cm('m-post')">‚úï</button></div>
  <div class="fg"><label class="fl">–¢–µ–∫—Å—Ç RU</label><textarea class="fta" id="pt-ru" placeholder="–¢–µ–∫—Å—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º..."></textarea></div>
  <div class="fg"><label class="fl">–¢–µ–∫—Å—Ç UK</label><textarea class="fta" id="pt-uk" placeholder="–¢–µ–∫—Å—Ç —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é..."></textarea></div>
  <div class="fr2">
    <div class="fg"><label class="fl">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label><select class="fs" id="pt-cat"><option value="">‚Äî –ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option></select></div>
    <div class="fg"><label class="fl">–°—Ç–∞—Ç—É—Å</label>
      <select class="fs" id="pt-st" onchange="document.getElementById('pt-sw').style.display=this.value==='scheduled'?'block':'none'">
        <option value="draft">üìù –ß–µ—Ä–Ω–æ–≤–∏–∫</option>
        <option value="scheduled">‚è≥ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</option>
        <option value="published">üì§ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–µ–π—á–∞—Å</option>
      </select>
    </div>
  </div>
  <div id="pt-sw" style="display:none" class="fg"><label class="fl">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</label><input class="fi" type="datetime-local" id="pt-dt"></div>
  <div class="fa">
    <button class="btn bp" onclick="createPost()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    <button class="btn bg" onclick="cm('m-post')">–û—Ç–º–µ–Ω–∞</button>
  </div>
</div></div>

<!-- Edit Post -->
<div id="m-edit-post" class="mo" style="display:none" onclick="if(event.target===this)cm('m-edit-post')">
<div class="mb">
  <div class="mt">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å—Ç <button class="mc" onclick="cm('m-edit-post')">‚úï</button></div>
  <input type="hidden" id="ep-id">
  <div class="fg"><label class="fl">–¢–µ–∫—Å—Ç RU</label><textarea class="fta" id="ep-ru"></textarea></div>
  <div class="fg"><label class="fl">–¢–µ–∫—Å—Ç UK</label><textarea class="fta" id="ep-uk"></textarea></div>
  <div class="fr2">
    <div class="fg"><label class="fl">–°—Ç–∞—Ç—É—Å</label>
      <select class="fs" id="ep-st">
        <option value="draft">üìù –ß–µ—Ä–Ω–æ–≤–∏–∫</option>
        <option value="scheduled">‚è≥ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å</option>
        <option value="published">üì§ –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω</option>
      </select>
    </div>
    <div class="fg"><label class="fl">–î–∞—Ç–∞</label><input class="fi" type="datetime-local" id="ep-dt"></div>
  </div>
  <div class="fa">
    <button class="btn bp" onclick="updatePost()">üíæ –û–±–Ω–æ–≤–∏—Ç—å</button>
    <button class="btn bg" onclick="cm('m-edit-post')">–û—Ç–º–µ–Ω–∞</button>
  </div>
</div></div>

<!-- Category -->
<div id="m-cat" class="mo" style="display:none" onclick="if(event.target===this)cm('m-cat')">
<div class="mb">
  <div class="mt">–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è <button class="mc" onclick="cm('m-cat')">‚úï</button></div>
  <div class="fg"><label class="fl">–ù–∞–∑–≤–∞–Ω–∏–µ RU</label><input class="fi" id="cat-ru" placeholder="–ù–æ–≤–æ—Å—Ç–∏"></div>
  <div class="fg"><label class="fl">–ù–∞–∑–≤–∞–Ω–∏–µ UK</label><input class="fi" id="cat-uk" placeholder="–ù–æ–≤–∏–Ω–∏"></div>
  <div class="fg"><label class="fl">–ò–∫–æ–Ω–∫–∞</label><input class="fi" id="cat-ic" placeholder="üì∞" maxlength="4" style="width:80px"></div>
  <div class="fa"><button class="btn bp" onclick="createCat()">üíæ –°–æ–∑–¥–∞—Ç—å</button><button class="btn bg" onclick="cm('m-cat')">–û—Ç–º–µ–Ω–∞</button></div>
</div></div>

<!-- Ad Campaign -->
<div id="m-ad" class="mo" style="display:none" onclick="if(event.target===this)cm('m-ad')">
<div class="mb">
  <div class="mt">–ù–æ–≤–∞—è –∫–∞–º–ø–∞–Ω–∏—è <button class="mc" onclick="cm('m-ad')">‚úï</button></div>
  <div class="fg"><label class="fl">–¢–µ–∫—Å—Ç —Ä–µ–∫–ª–∞–º—ã</label><textarea class="fta" id="ad-tx" placeholder="–†–µ–∫–ª–∞–º–Ω—ã–π —Ç–µ–∫—Å—Ç..."></textarea></div>
  <div class="fr2">
    <div class="fg"><label class="fl">–†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—å</label><input class="fi" id="ad-adv" placeholder="–ö–æ–º–ø–∞–Ω–∏—è"></div>
    <div class="fg"><label class="fl">–ë—é–¥–∂–µ—Ç (UAH)</label><input class="fi" id="ad-bud" type="number" placeholder="1000"></div>
  </div>
  <div class="fr2">
    <div class="fg"><label class="fl">–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</label><input class="fi" type="datetime-local" id="ad-pub"></div>
    <div class="fg"><label class="fl">–£–¥–∞–ª–∏—Ç—å —á–µ—Ä–µ–∑</label>
      <select class="fs" id="ad-del"><option value="0">–ù–µ —É–¥–∞–ª—è—Ç—å</option><option value="1">1 —á–∞—Å</option><option value="6">6 —á–∞—Å–æ–≤</option><option value="24">24 —á–∞—Å–∞</option><option value="72">3 –¥–Ω—è</option></select>
    </div>
  </div>
  <div class="fa"><button class="btn bp" onclick="createAd()">üíæ –°–æ–∑–¥–∞—Ç—å</button><button class="btn bg" onclick="cm('m-ad')">–û—Ç–º–µ–Ω–∞</button></div>
</div></div>

<!-- Edit Hero -->
<div id="m-hero" class="mo" style="display:none" onclick="if(event.target===this)cm('m-hero')">
<div class="mb">
  <div class="mt">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ <button class="mc" onclick="cm('m-hero')">‚úï</button></div>
  <div class="fg"><label class="fl">–ò–º—è</label><input class="fi" id="h-nm"></div>
  <div class="fg"><label class="fl">–ë–∏–æ–≥—Ä–∞—Ñ–∏—è RU</label><textarea class="fta" id="h-bru"></textarea></div>
  <div class="fg"><label class="fl">–ë–∏–æ–≥—Ä–∞—Ñ–∏—è UK</label><textarea class="fta" id="h-buk"></textarea></div>
  <div class="fg"><label class="fl">Biography EN</label><textarea class="fta" id="h-ben"></textarea></div>
  <div class="fg"><label class="fl">–õ–∏—á–Ω–æ—Å—Ç—å / –°—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è</label><textarea class="fta" id="h-per" placeholder="–•–∞—Ä–∞–∫—Ç–µ—Ä, –º–∞–Ω–µ—Ä–∞ —Ä–µ—á–∏, –∏–Ω—Ç–µ—Ä–µ—Å—ã..."></textarea></div>
  <div class="fa"><button class="btn bp" onclick="saveHero()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button><button class="btn bg" onclick="cm('m-hero')">–û—Ç–º–µ–Ω–∞</button></div>
</div></div>

<!-- Poster -->
<div id="m-poster" class="mo" style="display:none" onclick="if(event.target===this)cm('m-poster')">
<div class="mb">
  <div class="mt">–ü–æ—Å—Ç–µ—Ä –Ω–∞–¥ –ø—É–ª—å—Ç–æ–º <button class="mc" onclick="cm('m-poster')">‚úï</button></div>
  <div style="font-size:11px;color:var(--muted);margin-bottom:14px;line-height:1.6">–ö–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è ¬´–æ—Ç–∫—Ä—ã—Ç–∫–∞¬ª. –ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç —Å–ª—É—á–∞–π–Ω—É—é –ø—Ä–∏ –≤—Ö–æ–¥–µ.</div>
  <div class="fg"><label class="fl">–¢–µ–∫—Å—Ç (–∑–∞–≥–æ–ª–æ–≤–æ–∫)</label><input class="fi" id="ps-tx" placeholder="–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø—É–ª—å—Ç!"></div>
  <div class="fg"><label class="fl">–ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫</label><input class="fi" id="ps-sb" placeholder="–°–æ–∑–¥–∞–≤–∞–π. –†–∞—Å—Ç–∏. –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π."></div>
  <div class="fg"><label class="fl">Emoji / –ò–∫–æ–Ω–∫–∞</label><input class="fi" id="ps-em" placeholder="üî•" maxlength="4" style="width:80px"></div>
  <div class="fa"><button class="btn bp" onclick="addPoster()">+ –î–æ–±–∞–≤–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç</button><button class="btn bg" onclick="cm('m-poster')">–ó–∞–∫—Ä—ã—Ç—å</button></div>
</div></div>

<!-- Setup -->
<div id="setupOv" class="setup-ov" style="display:none">
<div class="setup-box">
  <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;background:linear-gradient(135deg,#a855f7,#3b82f6);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:4px">OMNI-CONTROL</div>
  <div style="font-size:10px;color:var(--muted);letter-spacing:1px;margin-bottom:20px">–ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ö API</div>
  <div class="fg"><label class="fl">IP —Å–µ—Ä–≤–µ—Ä–∞</label><input class="fi" id="su" placeholder="http://123.45.67.89"></div>
  <div class="fg"><label class="fl">API Secret Key</label><input class="fi" id="sk" placeholder="–∏–∑ .env —Ñ–∞–π–ª–∞" type="password"></div>
  <button class="btn bp" style="width:100%;margin-bottom:10px" onclick="saveConfig()">üîå –ü–û–î–ö–õ–Æ–ß–ò–¢–¨</button>
  <button class="btn bg" style="width:100%;font-size:10px" onclick="demoMode()">üëÅ –î–ï–ú–û ‚Äî —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ API</button>
  <div id="se" style="color:var(--red);font-size:11px;margin-top:10px;text-align:center;display:none"></div>
</div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let DEMO = false;
const CFG = {
  get url(){ return localStorage.getItem('omni_url')||''; },
  get key(){ return localStorage.getItem('omni_key')||''; },
};

const MOCK = {
  stats:{posts:24,ads:3,team:6,requests:2},
  posts:[
    {id:1,text_ru:"–ù–æ–≤—ã–π –ø–æ—Å—Ç –æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–µ –∏ —Ç—Ä–µ–Ω–¥–∞—Ö 2026",status:"published",created_at:"26.02.2026"},
    {id:2,text_ru:"–ê–Ω–æ–Ω—Å –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –¥–ª—è –∞—É–¥–∏—Ç–æ—Ä–∏–∏",status:"draft",created_at:"25.02.2026"},
    {id:3,text_ru:"–¢—Ä–µ–Ω–¥—ã SMM 2026 ‚Äî —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å",status:"scheduled",created_at:"27.02.2026"},
    {id:4,text_ru:"–ö–µ–π—Å —Ä–æ—Å—Ç–∞ –∞—É–¥–∏—Ç–æ—Ä–∏–∏ —Å –Ω—É–ª—è –¥–æ 50–∫",status:"published",created_at:"24.02.2026"},
    {id:5,text_ru:"7 –æ—à–∏–±–æ–∫ –Ω–∞—á–∏–Ω–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç-–º–µ–π–∫–µ—Ä–∞",status:"draft",created_at:"23.02.2026"},
  ],
  cats:[{id:1,name_ru:"–ù–æ–≤–æ—Å—Ç–∏",icon:"üì∞"},{id:2,name_ru:"–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥",icon:"üìà"},{id:3,name_ru:"–ö–µ–π—Å—ã",icon:"üí°"}],
  ads:[
    {id:1,text:"–†–µ–∫–ª–∞–º–∞ –ø—Ä–æ–¥—É–∫—Ç–∞ X ‚Äî —É–∑–Ω–∞–π –±–æ–ª—å—à–µ",advertiser:"–û–û–û –†–æ–≥–∞ –∏ –ö–æ–ø—ã—Ç–∞",status:"active",ctr:"4.2%",budget:"500 UAH"},
    {id:2,text:"–ü—Ä–æ–º–æ –∞–∫—Ü–∏—è —Ñ–µ–≤—Ä–∞–ª—å ‚Äî —Å–∫–∏–¥–∫–∏ –¥–æ 50%",advertiser:"–ò–ü –ü—Ä–∏–º–∞–∫–æ–≤",status:"pending",ctr:"‚Äî",budget:"1200 UAH"},
    {id:3,text:"–ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–π –ø–æ—Å—Ç ‚Äî —Å–ø–æ–Ω—Å–æ—Ä –≤—ã–ø—É—Å–∫–∞",advertiser:"–ß–ü –°—Ç–∞—Ä—Ç",status:"cancelled",ctr:"1.8%",budget:"300 UAH"},
  ],
  team:[
    {id:103920773,name:"Goulash1986",role:"owner",date:"01.01.2026"},
    {id:2,name:"–ê–Ω–¥—Ä–µ–π –ê.",role:"admin",date:"10.01.2026"},
    {id:3,name:"–ú–∞—Ä–∏—è –ö.",role:"editor",date:"15.02.2026"},
  ],
  requests:[
    {id:1,name:"–ò–≤–∞–Ω –ü.",msg:"–•–æ—á—É –ø–æ–º–æ–≥–∞—Ç—å —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º"},
    {id:2,name:"–ê–Ω–Ω–∞ –°.",msg:"SMM-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç, 3 –≥–æ–¥–∞ –æ–ø—ã—Ç–∞"},
  ],
  hero:{exists:true,name:"–ê–õ–ò–ù–´–ß –ê–ù–î–†–ï–ï–í–ò–ß",bio:"–≠–∫—Å–ø–µ—Ä—Ç –≤ digital-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥–µ –∏ SMM.",bio_ru:"–≠–∫—Å–ø–µ—Ä—Ç –≤ digital-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥–µ –∏ SMM.",bio_uk:"–ï–∫—Å–ø–µ—Ä—Ç –∑ digital-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É —Ç–∞ SMM.",bio_en:"Digital marketing & SMM expert.",personality:"–≠–Ω–µ—Ä–≥–∏—á–Ω—ã–π, –≥–æ–≤–æ—Ä–∏—Ç –Ω–∞ —Ç—ã. –õ—é–±–∏—Ç –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫—É –∏ —é–º–æ—Ä. –ù–µ —Ç–µ—Ä–ø–∏—Ç –≤–æ–¥—ã –≤ —Ç–µ–∫—Å—Ç–∞—Ö."},
  roi:{impressions:12400,clicks:520,ctr:4.2},
  activity:[
    {icon:"üì§",text:"–ü–æ—Å—Ç #4 –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –≤ –∫–∞–Ω–∞–ª",time:"—Å–µ–≥–æ–¥–Ω—è 14:22"},
    {icon:"‚úÖ",text:"–ó–∞—è–≤–∫–∞ –ò–≤–∞–Ω–∞ –ü. –æ–¥–æ–±—Ä–µ–Ω–∞",time:"—Å–µ–≥–æ–¥–Ω—è 12:10"},
    {icon:"üíº",text:"–†–µ–∫–ª–∞–º–∞ #1 –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞",time:"–≤—á–µ—Ä–∞ 18:45"},
    {icon:"üö®",text:"PANIC MODE –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω",time:"23.02 09:15"},
  ],
  logs:[
    {action:"publish_post",author:"Goulash1986",entity:"–ü–æ—Å—Ç #4",time:"26.02 14:22"},
    {action:"ban_user",author:"Goulash1986",entity:"User #99",time:"26.02 12:10"},
    {action:"change_role",author:"Goulash1986",entity:"–ú–∞—Ä–∏—è –ö. ‚Üí Editor",time:"25.02 18:45"},
    {action:"approve_join_request",author:"Goulash1986",entity:"–ò–≤–∞–Ω –ü.",time:"25.02 11:30"},
    {action:"panic_mode",author:"Goulash1986",entity:"–°–∏—Å—Ç–µ–º–∞",time:"23.02 09:15"},
  ],
  posters:[
    {emoji:"üî•",title:"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",sub:"–°–æ–∑–¥–∞–≤–∞–π –∫–æ–Ω—Ç–µ–Ω—Ç. –†–∞—Å—Ç–∏. –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π."},
    {emoji:"üí°",title:"–ü—É–ª—å—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è",sub:"–í—Å—ë –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º. –¢—ã ‚Äî –ê–ª–∏–Ω—ã—á –ê–Ω–¥—Ä–µ–µ–≤–∏—á."},
  ]
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
document.addEventListener('DOMContentLoaded', () => {
  if (!CFG.url || !CFG.key) {
    document.getElementById('setupOv').style.display = 'flex';
  } else {
    loadAll();
  }
});

function loadAll() {
  loadDashboard();
  loadContent();
  loadCats();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NAV
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function gp(id, btn) {
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.nb').forEach(b=>b.classList.remove('active'));
  document.getElementById('page-'+id).classList.add('active');
  btn.classList.add('active');
  const map={content:()=>{loadContent();loadCats();},ads:loadAds,finance:loadFinance,team:loadTeam,hero:loadHero,logs:()=>loadLogs('all')};
  if(map[id]) map[id]();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// API FETCH
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function apiFetch(path, method='GET', body=null) {
  const opts = {method, headers:{'X-Api-Key':CFG.key,'Content-Type':'application/json'}};
  if (body) opts.body = JSON.stringify(body);
  const r = await fetch(CFG.url+path, opts);
  if (!r.ok) throw new Error('API '+r.status);
  return r.json();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DASHBOARD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function loadDashboard() {
  let d;
  if (DEMO) {
    d = {stats:MOCK.stats, posts_by_day:[{date:'21',count:2},{date:'22',count:1},{date:'23',count:3},{date:'24',count:2},{date:'25',count:4},{date:'26',count:1}], post_statuses:{published:14,drafts:7,scheduled:3}, roi:MOCK.roi, activity:MOCK.activity};
  } else { try{d=await apiFetch('/api/dashboard');}catch(e){return;} }

  cnt('s-p',d.stats.posts); cnt('s-a',d.stats.ads); cnt('s-t',d.stats.team); cnt('s-r',d.stats.requests);
  document.getElementById('rBdg').textContent = d.stats.requests;

  g('feed').innerHTML = d.activity.map(a=>
    `<div class="feed-item"><div class="feed-ic">${a.icon}</div><div><div style="font-size:12px">${a.text}</div><div style="font-size:10px;color:var(--muted);margin-top:2px">${a.time}</div></div></div>`
  ).join('');

  const roi=d.roi;
  setTimeout(()=>{bw('bI',100);bw('bC',roi.impressions?roi.clicks/roi.impressions*100:0);bw('bT',roi.ctr/10*100);},100);
  g('vI').textContent=(roi.impressions||0).toLocaleString();
  g('vC').textContent=(roi.clicks||0).toLocaleString();
  g('vT').textContent=roi.ctr+'%';

  drawBar('cPosts', d.posts_by_day.map(x=>x.date), d.posts_by_day.map(x=>x.count));
  const s=d.post_statuses;
  drawDonut('cStatus',['–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ','–ß–µ—Ä–Ω–æ–≤–∏–∫–∏','–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ'],[s.published,s.drafts,s.scheduled]);
}

function drawBar(id,labels,data){
  const ctx=g(id)?.getContext('2d'); if(!ctx)return;
  if(window['_c'+id])window['_c'+id].destroy();
  window['_c'+id]=new Chart(ctx,{type:'bar',data:{labels,datasets:[{data,backgroundColor:'rgba(124,58,237,.5)',borderColor:'rgba(168,85,247,.8)',borderWidth:1,borderRadius:4}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{x:{grid:{color:'rgba(42,42,58,.5)'},ticks:{color:'#64748b',font:{size:10}}},y:{grid:{color:'rgba(42,42,58,.5)'},ticks:{color:'#64748b',font:{size:10},stepSize:1}}}}});
}
function drawDonut(id,labels,data){
  const ctx=g(id)?.getContext('2d'); if(!ctx)return;
  if(window['_c'+id])window['_c'+id].destroy();
  window['_c'+id]=new Chart(ctx,{type:'doughnut',data:{labels,datasets:[{data,backgroundColor:['rgba(16,185,129,.7)','rgba(100,116,139,.5)','rgba(245,158,11,.7)'],borderColor:['#10b981','#475569','#f59e0b'],borderWidth:1}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{color:'#64748b',font:{size:10},padding:10}}},cutout:'65%'}});
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CONTENT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let _cf='all';

async function loadContent() {
  let posts;
  if(DEMO){posts=MOCK.posts;}
  else{try{const d=await apiFetch(`/api/posts?status=${_cf}`);posts=d.posts;}catch(e){return;}}

  const fl=_cf==='all'?posts:posts.filter(p=>p.status===_cf);
  const sc={published:'st-pub',draft:'st-drf',scheduled:'st-sch',deleted:'st-del'};
  const st={published:'–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω',draft:'–ß–µ—Ä–Ω–æ–≤–∏–∫',scheduled:'–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω',deleted:'–£–¥–∞–ª—ë–Ω'};
  g('conTbl').innerHTML=fl.length?fl.map(p=>`
    <tr>
      <td><div style="font-size:12px;font-weight:600">#${p.id}</div><div style="font-size:11px;color:var(--muted);margin-top:2px">${(p.text_ru||p.text||'').substring(0,60)}</div></td>
      <td><span class="st ${sc[p.status]||'st-drf'}">${st[p.status]||p.status}</span></td>
      <td style="font-size:11px;color:var(--muted)">${p.created_at}</td>
      <td><div style="display:flex;gap:6px">
        <button class="btn bg bsm" onclick="editPost(${p.id})">‚úèÔ∏è</button>
        <button class="btn bd bsm" onclick="delPost(${p.id})">üóë</button>
      </div></td>
    </tr>`).join(''):'<tr><td colspan="4" style="text-align:center;color:var(--muted);padding:24px">–ù–µ—Ç –ø–æ—Å—Ç–æ–≤</td></tr>';
}

async function loadCats() {
  let cats;
  if(DEMO){cats=MOCK.cats;}
  else{try{const d=await apiFetch('/api/categories');cats=d.categories;}catch(e){cats=[];}}
  g('catList').innerHTML=cats.length?cats.map(c=>
    `<div style="display:flex;align-items:center;gap:5px;background:var(--bg3);border:1px solid var(--border);border-radius:6px;padding:4px 10px;font-size:11px">${c.icon||'üìÅ'} ${c.name_ru} <button onclick="delCat(${c.id})" style="background:none;border:none;color:var(--muted);cursor:pointer;font-size:12px;margin-left:4px">‚úï</button></div>`
  ).join(''):'<span style="font-size:11px;color:var(--muted)">–ù–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π</span>';
  const sel=g('pt-cat');
  if(sel) sel.innerHTML='<option value="">‚Äî –ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>'+cats.map(c=>`<option value="${c.id}">${c.icon||''} ${c.name_ru}</option>`).join('');
}

function fCon(f,btn){
  _cf=f;
  document.querySelectorAll('#page-content .tab').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  loadContent();
}

async function createPost(){
  const data={text_ru:g('pt-ru').value,text_uk:g('pt-uk').value,category_id:g('pt-cat').value||null,status:g('pt-st').value,schedule_at:g('pt-dt').value||null};
  if(!data.text_ru&&!data.text_uk){alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç');return;}
  if(DEMO){MOCK.posts.unshift({id:Date.now(),text_ru:data.text_ru||data.text_uk,status:data.status,created_at:new Date().toLocaleDateString('ru')});}
  else{try{await apiFetch('/api/posts','POST',data);}catch(e){alert('–û—à–∏–±–∫–∞: '+e.message);return;}}
  cm('m-post'); g('pt-ru').value=''; g('pt-uk').value=''; loadContent();
}

function editPost(id){
  const p=MOCK.posts.find(x=>x.id===id)||{id,text_ru:'',text_uk:'',status:'draft'};
  g('ep-id').value=id; g('ep-ru').value=p.text_ru||''; g('ep-uk').value=p.text_uk||''; g('ep-st').value=p.status||'draft';
  om('m-edit-post');
}

async function updatePost(){
  const id=parseInt(g('ep-id').value);
  const data={text_ru:g('ep-ru').value,text_uk:g('ep-uk').value,status:g('ep-st').value,schedule_at:g('ep-dt').value||null};
  if(DEMO){const p=MOCK.posts.find(x=>x.id===id);if(p){p.text_ru=data.text_ru;p.status=data.status;}}
  else{try{await apiFetch('/api/posts/'+id,'PUT',data);}catch(e){alert('–û—à–∏–±–∫–∞');return;}}
  cm('m-edit-post'); loadContent();
}

async function delPost(id){
  if(!confirm('–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç #'+id+'?'))return;
  if(DEMO){MOCK.posts=MOCK.posts.filter(p=>p.id!==id);}
  else{try{await apiFetch('/api/posts/'+id,'DELETE');}catch(e){alert('–û—à–∏–±–∫–∞');return;}}
  loadContent();
}

async function createCat(){
  const data={name_ru:g('cat-ru').value,name_uk:g('cat-uk').value,icon:g('cat-ic').value};
  if(!data.name_ru){alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ');return;}
  if(DEMO){MOCK.cats.push({id:Date.now(),name_ru:data.name_ru,icon:data.icon});}
  else{try{await apiFetch('/api/categories','POST',data);}catch(e){alert('–û—à–∏–±–∫–∞');return;}}
  cm('m-cat'); g('cat-ru').value=''; g('cat-uk').value=''; g('cat-ic').value=''; loadCats();
}

async function delCat(id){
  if(DEMO){MOCK.cats=MOCK.cats.filter(c=>c.id!==id);loadCats();return;}
  try{await apiFetch('/api/categories/'+id,'DELETE');loadCats();}catch(e){alert('–û—à–∏–±–∫–∞');}
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ADS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function loadAds(){
  let d;
  if(DEMO){d={stats:{active:1,pending:1,budget:'2000',ctr:'4.2%'},ads:MOCK.ads};}
  else{try{d=await apiFetch('/api/ads');}catch(e){return;}}
  g('aAct').textContent=d.stats.active; g('aPen').textContent=d.stats.pending;
  g('aBud').textContent=d.stats.budget||'‚Äî'; g('aCtr').textContent=d.stats.ctr;
  const sc={active:'st-act',pending:'st-pen',cancelled:'st-can',completed:'st-pub'};
  const st={active:'–ê–∫—Ç–∏–≤–Ω–∞',pending:'–û–∂–∏–¥–∞–µ—Ç',cancelled:'–û—Ç–º–µ–Ω–µ–Ω–∞',completed:'–ó–∞–≤–µ—Ä—à–µ–Ω–∞'};
  g('adsTbl').innerHTML=d.ads.map(a=>`
    <tr>
      <td><div style="font-size:11px;font-weight:600">#${a.id}</div><div style="font-size:11px;color:var(--muted)">${a.text.substring(0,45)}</div></td>
      <td style="font-size:11px;color:var(--muted)">${a.advertiser||'‚Äî'}</td>
      <td><span class="st ${sc[a.status]||'st-drf'}">${st[a.status]||a.status}</span></td>
      <td style="font-size:12px">${a.ctr}</td>
      <td style="font-size:11px;color:var(--muted)">${a.budget}</td>
      <td><div style="display:flex;gap:5px">
        ${a.status==='pending'?`<button class="btn bsuc bsm" onclick="activateAd(${a.id})">‚ñ∂</button>`:''}
        <button class="btn bd bsm" onclick="delAd(${a.id})">üóë</button>
      </div></td>
    </tr>`).join('');
}

async function createAd(){
  const data={text:g('ad-tx').value,advertiser:g('ad-adv').value,budget:g('ad-bud').value,publish_at:g('ad-pub').value,delete_after:g('ad-del').value};
  if(!data.text){alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç');return;}
  if(DEMO){MOCK.ads.unshift({id:Date.now(),text:data.text,advertiser:data.advertiser,status:'pending',ctr:'‚Äî',budget:(data.budget||'0')+' UAH'});}
  else{try{await apiFetch('/api/ads','POST',data);}catch(e){alert('–û—à–∏–±–∫–∞');return;}}
  cm('m-ad'); g('ad-tx').value=''; loadAds();
}

async function activateAd(id){
  if(DEMO){const a=MOCK.ads.find(x=>x.id===id);if(a)a.status='active';}
  else{try{await apiFetch('/api/ads/'+id+'/activate','POST');}catch(e){alert('–û—à–∏–±–∫–∞');return;}}
  loadAds();
}

async function delAd(id){
  if(!confirm('–£–¥–∞–ª–∏—Ç—å –∫–∞–º–ø–∞–Ω–∏—é #'+id+'?'))return;
  if(DEMO){MOCK.ads=MOCK.ads.filter(a=>a.id!==id);}
  else{try{await apiFetch('/api/ads/'+id,'DELETE');}catch(e){alert('–û—à–∏–±–∫–∞');return;}}
  loadAds();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FINANCE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function loadFinance(){
  let d;
  if(DEMO){
    const adv=[{name:'–û–û–û –†–æ–≥–∞ –∏ –ö–æ–ø—ã—Ç–∞',budget:500,campaigns:1},{name:'–ò–ü –ü—Ä–∏–º–∞–∫–æ–≤',budget:1200,campaigns:1},{name:'–ß–ü –°—Ç–∞—Ä—Ç',budget:300,campaigns:1}];
    d={income:2000,expense:200,profit:1800,campaigns:3,total_budget:2000,avg_budget:667,done_campaigns:1,advertisers:adv};
  } else{try{d=await apiFetch('/api/finance');}catch(e){return;}}
  cnt('fInc',d.income||0); cnt('fExp',d.expense||0); cnt('fPro',d.profit||0); cnt('fCam',d.campaigns||0);
  g('fTot').textContent=(d.total_budget||0)+' UAH';
  g('fAvg').textContent=Math.round(d.avg_budget||0)+' UAH';
  g('fAct2').textContent=d.campaigns||0;
  g('fDone').textContent=d.done_campaigns||0;
  g('finTbl').innerHTML=(d.advertisers||[]).length?`<table class="tbl"><thead><tr><th>–†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—å</th><th>–ë—é–¥–∂–µ—Ç</th><th>–ö–∞–º–ø–∞–Ω–∏–π</th></tr></thead><tbody>${(d.advertisers||[]).map(a=>`<tr><td style="font-size:12px">${a.name}</td><td style="color:var(--green);font-size:12px">${a.budget} UAH</td><td>${a.campaigns}</td></tr>`).join('')}</tbody></table>`:'<div style="color:var(--muted);font-size:12px">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TEAM
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function loadTeam(){
  let d;
  if(DEMO){d={members:MOCK.team,requests:MOCK.requests};}
  else{try{d=await apiFetch('/api/team');}catch(e){return;}}
  if(d.requests?.length){
    g('reqBlk').style.display='block';
    g('reqLst').innerHTML=d.requests.map(r=>`<div style="display:flex;align-items:center;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--border)"><div><div style="font-size:12px;font-weight:600">${r.name}</div><div style="font-size:11px;color:var(--muted)">${r.msg}</div></div><div style="font-size:10px;color:var(--muted)">–û–¥–æ–±—Ä–∏—Ç—å –≤ –±–æ—Ç–µ ‚Üí</div></div>`).join('');
  } else g('reqBlk').style.display='none';
  const rc={owner:'rl-o',admin:'rl-a',editor:'rl-e'};
  const rt={owner:'Owner',admin:'Admin',editor:'Editor',analyst:'Analyst'};
  g('teamTbl').innerHTML=d.members.map(u=>`<tr><td><div style="display:flex;align-items:center;gap:10px"><div class="av">${(u.name||'?')[0]}</div><div style="font-size:12px">${u.name}</div></div></td><td><span class="rl ${rc[u.role]||''}">${rt[u.role]||u.role}</span></td><td style="font-size:11px;color:var(--muted)"><code>${u.id}</code></td><td style="font-size:11px;color:var(--muted)">${u.date}</td></tr>`).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HERO
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function loadHero(){
  let h;
  if(DEMO){h=MOCK.hero;}
  else{try{h=await apiFetch('/api/hero');}catch(e){return;}}
  if(!h.exists){g('hName').textContent='–ü–µ—Ä—Å–æ–Ω–∞–∂ –Ω–µ —Å–æ–∑–¥–∞–Ω';g('hBio').textContent='–°–æ–∑–¥–∞–π—Ç–µ –≤ –±–æ—Ç–µ';return;}
  g('hName').textContent=h.name; g('hBio').textContent=h.bio;
  g('hBioRu').textContent=h.bio_ru; g('hBioUk').textContent=h.bio_uk; g('hBioEn').textContent=h.bio_en;
  g('hPers').textContent=h.personality||'‚Äî';
  renderPosters();
}

function openEditHero(){
  const h=MOCK.hero;
  g('h-nm').value=h.name||''; g('h-bru').value=h.bio_ru||''; g('h-buk').value=h.bio_uk||'';
  g('h-ben').value=h.bio_en||''; g('h-per').value=h.personality||'';
  om('m-hero');
}

async function saveHero(){
  const data={name:g('h-nm').value,bio_ru:g('h-bru').value,bio_uk:g('h-buk').value,bio_en:g('h-ben').value,personality:g('h-per').value};
  if(DEMO){Object.assign(MOCK.hero,data);MOCK.hero.bio=data.bio_ru;}
  else{try{await apiFetch('/api/hero','PUT',data);}catch(e){alert('–û—à–∏–±–∫–∞: '+e.message);return;}}
  cm('m-hero'); loadHero();
}

function renderPosters(){
  const p=MOCK.posters;
  g('posterList').innerHTML=p.length?p.map((x,i)=>`
    <div style="display:flex;align-items:center;gap:10px;background:var(--bg3);border:1px solid var(--border);border-radius:8px;padding:10px;margin-bottom:8px">
      <span style="font-size:26px">${x.emoji}</span>
      <div style="flex:1"><div style="font-size:12px;font-weight:600">${x.title}</div><div style="font-size:11px;color:var(--muted);margin-top:2px">${x.sub}</div></div>
      <button onclick="delPoster(${i})" style="background:none;border:none;color:var(--red);cursor:pointer;font-size:16px">‚úï</button>
    </div>`).join(''):'<div style="color:var(--muted);font-size:11px">–ù–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤. –î–æ–±–∞–≤—å –ø–µ—Ä–≤—ã–π!</div>';
}

function addPoster(){
  const text=g('ps-tx').value, sub=g('ps-sb').value, emoji=g('ps-em').value||'üî•';
  if(!text){alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç');return;}
  MOCK.posters.push({emoji,title:text,sub:sub});
  g('ps-tx').value=''; g('ps-sb').value=''; g('ps-em').value='';
  renderPosters();
}

function delPoster(i){MOCK.posters.splice(i,1);renderPosters();}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// LOGS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function loadLogs(f){
  let logs;
  if(DEMO){logs=MOCK.logs;}
  else{try{const d=await apiFetch(`/api/logs?filter=${f}`);logs=d.logs;}catch(e){return;}}
  const al={publish_post:"üì§ –ü—É–±–ª–∏–∫–∞—Ü–∏—è",ban_user:"üö´ –ë–∞–Ω",unban_user:"‚úÖ –†–∞–∑–±–∞–Ω",change_role:"üîÑ –°–º–µ–Ω–∞ —Ä–æ–ª–∏",approve_join_request:"‚úÖ –ó–∞—è–≤–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∞",reject_join_request:"‚ùå –ó–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞",panic_mode:"üö® Panic Mode",delete_post:"üóë –£–¥–∞–ª–µ–Ω–∏–µ"};
  g('logsTbl').innerHTML=logs.length?logs.map(l=>`<tr><td style="font-size:12px">${al[l.action]||l.action}</td><td style="font-size:11px;color:var(--muted)">${l.author||'‚Äî'}</td><td style="font-size:11px;color:var(--muted)">${l.entity||'‚Äî'}</td><td style="font-size:11px;color:var(--muted)">${l.time}</td></tr>`).join(''):'<tr><td colspan="4" style="text-align:center;color:var(--muted);padding:24px">–ù–µ—Ç –ª–æ–≥–æ–≤</td></tr>';
}

function fLog(f,btn){
  document.querySelectorAll('#page-logs .tab').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active'); loadLogs(f);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// BOT SETTINGS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function saveBotSettings(){
  alert('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!\n–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –±–æ—Ç —á–µ—Ä–µ–∑ start.bat —á—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.');
}
function confirmRestart(){
  if(confirm('–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞?')) alert('–ö–æ–º–∞–Ω–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –±–æ—Ç—É. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ start.bat –≤—Ä—É—á–Ω—É—é.');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MODAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function om(id){document.getElementById(id).style.display='flex';}
function cm(id){document.getElementById(id).style.display='none';}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SETUP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showSetup(){
  const o=g('setupOv'); o.style.display='flex';
  g('su').value=CFG.url; g('sk').value=CFG.key;
}

async function saveConfig(){
  const url=g('su').value.trim().replace(/\/$/,''), key=g('sk').value.trim();
  if(!url||!key)return;
  try{
    const r=await fetch(url+'/',{headers:{'X-Api-Key':key}});
    if(!r.ok) throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á –∏–ª–∏ IP –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
    localStorage.setItem('omni_url',url); localStorage.setItem('omni_key',key);
    DEMO=false; g('setupOv').style.display='none'; loadAll();
  }catch(e){g('se').style.display='block';g('se').textContent='‚ùå '+e.message;}
}

function demoMode(){DEMO=true; g('setupOv').style.display='none'; loadAll();}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// UTILS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function g(id){return document.getElementById(id);}
function bw(id,pct){g(id).style.width=Math.min(100,Math.max(0,pct))+'%';}
function cnt(id,target){
  const e=g(id); if(!e)return; let c=0;
  const s=Math.ceil(target/20)||1;
  const t=setInterval(()=>{c=Math.min(c+s,target);e.textContent=c;if(c>=target)clearInterval(t);},50);
}

if(window.Telegram?.WebApp){
  const tg=window.Telegram.WebApp;
  tg.expand(); tg.setHeaderColor('#0a0a0f'); tg.setBackgroundColor('#0a0a0f');
}
</script>
</body>
</html>
